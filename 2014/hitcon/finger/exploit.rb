require 'socket'
require 'digest'
class Exploit
	def initialize
		@s = TCPSocket.new('210.71.253.236',7171)
	end

	def exploit
		3.times { puts @s.readline }
		@hands = @s.readline.gsub('"', '').gsub(" ", "")[7..-3].split(",")
		puts @s.readline
		puts @s.read("how many? ".length)
		@s.puts("1")
		puts @s.read("the magic? ".length)
		mine = @hands[0].ljust(16, "A")
		@s.puts Digest::MD5.hexdigest(mine).to_i(16)

		5.times { print @s.read(1) }
		puts
		yours = @s.readline[14..-2]
		index = @hands.index(yours)	
		print @s.read("show me the secret: ".length)

		if index == 0 or index == 2
			@s.puts mine
		else
			@s.puts "a" # i will cheat :)
		end

		puts @s.readline
	end
end
s = Exploit.new
loop do
	s.exploit
end
