require 'rubygems'
require 'rsa'
require 'socket'

class Exploit
	def initialize
		@s = TCPSocket.new('54.64.40.172', 5454)
	end

	def solve
		n = @s.readline.to_i
		m = @s.readline.to_i
		m_1 = @s.readline.to_i

#		n = 7 * 13
#		m = 3**3 % n
#		m_1 = 4**3 % n

		i_3 = RSA::Math.modinv(3, n)
		i_m = RSA::Math.modinv(m - 1, n)
		
		t = (m_1 - m - 1) % n 
		t = (t * i_3) % n

		answer = ((RSA::Math.modpow(t, 2, n) - t - 2 * m) * i_m) % n
		puts "Answer : %d" % answer
		@s.puts answer.to_s
		p @s.readline
	end
end

=begin
s = Exploit.new
11.times { s.solve }
=end
#Answer : 163554855920981642930553741163947442415491794235989756192875957861936245924759969344760971902949404770611500364708576710130676421835246926417066147023063612453790587329340191599745998993678119062546130850824658843219825102964690853699118700706889706567750458848891052298

answer = 163554855920981642930553741163947442415491794235989756192875957861936245924759969344760971902949404770611500364708576710130676421835246926417066147023063612453790587329340191599745998993678119062546130850824658843219825102964690853699118700706889706567750458848891052298

puts answer.to_s(16).scan(/../).map{|v| v.to_i(16).chr}.join
