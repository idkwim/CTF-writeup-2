from reedsolo import *
import struct

def find_data(b):
    string = ""
    for c in b:
        string += chr(c)

    for i in xrange(65536):
        try:
            rs = RSCodec(22)
            guess = bytearray("X"*11 + struct.pack('H', i) + string)
            s = rs.decode(guess)
            b = []
            map(lambda x:b.append(bin(x)[2:].rjust(8,"0")), s)
            return b
        except Exception, e:
            pass


r= ["01011010", "01011111", "00110101", "10101111", "10110101", "10001111", "00100011", "00110100", "01100100", "00110100", "10101101", "00100010", "10011011", "10011111", "01000011", "00001111", "01110000", "10110110", "01100100", "11111011", "10111111", "00000111", "11001100", "11001001", "01110101", "10111111", "11100110", "11100011", "11100001", "01011110", "10000000", "11010001", "01100011", "00001100", "00101011", "01000101", "10100010", "10111101", "00000101", "01101001", "01100001", "00111110", "10100111", "11110100"]

r = map(lambda x: int(x,2), r)
find_data(r[0:22])
find_data(r[22:])


