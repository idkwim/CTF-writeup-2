from gmpy2 import *
import base64

def egcd(a, b):
    x,y, u,v = 0,1, 1,0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a, x,y, u,v = a,r, u,v, m,n
    gcd = b
    return gcd, x, y

get_context().precision = 10000

n = 13581021844982208629690136078668824431082100296541844867917122591260430715258289012771394838930585022381145833877212718312045206202291717339885288641708639219712554727656325878238348392260116000137562450005650649482745216336585883349830282254421170712839868335044074850649335148817922334253018596452406368933660021256878533128176827030639571454284727773974122364316255590977158068950906461617689519552366356830055404222246836211188271238377966275005101279703296526737651741701982789698369235190671524591976755754359711744900731651713338266221575244054706195570859966975326941250531799406632308078416671559162832475697
A = ceil(sqrt(n))
x = sqrt(A ** 2 - n)

p = int(A - x)
q = n / p
e = 65537
enc = int(base64.b64decode("WUFqHt4XiHvajG+R+K09bBUpSCAlbIqSZkMdBM2ylsLaPQpy3D0Jw9s/0/KwCDPGhYERwYJ/f+G8b5mj08+Yoiwy1jz6dm/sr0+J7AL7Hecl9phWAsixn6afUN/jURSvZiqJaNfDA7CY6W/eUmZV8/n3946EsMqwZpz+YkYjsuuKmyyF2cutiQVwelPubOBAiLROs0HiB82g+pF9RuUXm2PmjQOYp9l8qOUD5MbxB1+92Iu7D4/kHdGrMS7kNJGCqNA8WLcU4f6x54UwOYLgwVdi9x117B7ucVUHrDTQPPjpz8VQYnQCjOu9ryzt4GNUGkUJqSsbhoRlfKapvH/dIg==").encode("hex"),16)

#print n % p, n % q
#print "p : %d\nq : %d" % (p, q)
#print enc


phi = (p-1) * (q-1)
gcd, x, d = egcd(phi, e)

print "Answer : %s" % hex(pow(enc, d, n))[2:-1].decode("hex")
